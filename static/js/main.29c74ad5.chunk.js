(this["webpackJsonpvk-mini-apps-empty"]=this["webpackJsonpvk-mini-apps-empty"]||[]).push([[0],{191:function(e,t,a){e.exports=a(310)},310:function(e,t,a){"use strict";a.r(t);a(192),a(218),a(220),a(221),a(223),a(224),a(225),a(226),a(227),a(228),a(229),a(230),a(232),a(233),a(234),a(235),a(236),a(237),a(238),a(239),a(240),a(241),a(243),a(244),a(245),a(246),a(247),a(248),a(249),a(250),a(251),a(252),a(253),a(254),a(255),a(256),a(257),a(258),a(259),a(260);var n=a(0),c=a.n(n),r=a(36),i=a.n(r),l=a(18),m=a.n(l),d=a(86),o=a.n(d),u=a(29),s=a(50),f=a.n(s),p=a(130),b=a.n(p),E=(a(269),a(8)),h=a(123),y=a.n(h),v=a(124),_=a.n(v),k=a(125),O=a.n(k),j=a(59),q=a.n(j),g=a(129),w=a.n(g),C=a(85),S=a.n(C),R=a(88),T=a.n(R),K=a(44),V=a.n(K),A=a(43),I=a.n(A),P=a(63),U=a.n(P),W=a(60),x=a.n(W),z=a(126),D=a(127),F=function(){function e(){Object(z.a)(this,e)}return Object(D.a)(e,null,[{key:"qr",value:function(e){var t,a,n,c,r;if(e){var i=e.match(/t=(\w{8}T\w+)&s=(\w+\.*\w+)&fn=(\w+)&i=(\w+)&fp=(\w+)/),l=Object(u.a)(i,6);t=l[1],a=l[2],n=l[3],c=l[4],r=l[5]}return{dt:t,sum:a,fn:n,i:c,fp:r}}},{key:"date",value:function(e){var t,a=new Date(e);switch(a.getMonth()+1){case 1:t="\u044f\u043d\u0432\u0430\u0440\u044f";break;case 2:t="\u0444\u0435\u0432\u0440\u0430\u043b\u044f";break;case 3:t="\u043c\u0430\u0440\u0442\u0430";break;case 4:t="\u0430\u043f\u0440\u0435\u043b\u044f";break;case 5:t="\u043c\u0430\u044f";break;case 6:t="\u0438\u044e\u043d\u044f";break;case 7:t="\u0438\u044e\u043b\u044f";break;case 8:t="\u0430\u0432\u0433\u0443\u0441\u0442\u0430";break;case 9:t="\u0441\u0435\u043d\u0442\u044f\u0431\u0440\u044f";break;case 10:t="\u043e\u043a\u0442\u044f\u0431\u0440\u044f";break;case 11:t="\u043d\u043e\u044f\u0431\u0440\u044f";break;case 12:t="\u0434\u0435\u043a\u0430\u0431\u0440\u044f"}return"".concat(a.getDate()," ").concat(t," ").concat(a.getFullYear())}},{key:"sum",value:function(e){return new Intl.NumberFormat("ru-RU",{style:"currency",currency:"RUB"}).format(e/100)}},{key:"totalReceiptSum",value:function(e){for(var t=0,a=e.map((function(e){return e.totalSum})),n=0;n<a.length;n++)t+=a[n];return t}}]),e}(),G=function(e){var t=e.sum,a=t>0?{color:"#28a745"}:{color:"#dc3545"};return c.a.createElement("span",{style:a},F.sum(t))},B=a(128),J=a.n(B),M=function(e){var t=e.id,a=e.go,r=e.fetchedUser,i=e.qr,l=e.receipts,d=Object(n.useState)(new Date),o=Object(u.a)(d,2),s=o[0];o[1];return c.a.createElement(w.a,{id:t},c.a.createElement(S.a,null,"\u0411\u0430\u043b\u0430\u043d\u0441"),r&&c.a.createElement(V.a,{title:"User Data Fetched with VK Connect"},c.a.createElement(I.a,{before:r.photo_200?c.a.createElement(x.a,{src:r.photo_200}):null,description:r.city&&r.city.title?r.city.title:""},"".concat(r.first_name," ").concat(r.last_name))),c.a.createElement(V.a,{title:"\u0411\u0430\u043b\u0430\u043d\u0441"},c.a.createElement(U.a,{style:{fontSize:"200%",fontWeight:"bold"}},c.a.createElement(G,{sum:F.totalReceiptSum(l)}))),c.a.createElement(V.a,{title:"\u041a\u0430\u043b\u0435\u043d\u0434\u0430\u0440\u044c"},c.a.createElement(J.a,{value:s})),c.a.createElement(V.a,{title:"\u0427\u0435\u043a\u0438"},c.a.createElement(E.i,null,l.map((function(e,t){return c.a.createElement(I.a,{key:t,expandable:!0,onClick:a,"data-to":e._id,indicator:c.a.createElement(G,{sum:e.totalSum})},F.date(e.dateTime))})))),c.a.createElement(V.a,{title:"Profile"},c.a.createElement(U.a,null,c.a.createElement(T.a,{size:"xl",level:"2",onClick:a,"data-to":"profile"},"Profile"))),c.a.createElement(V.a,{title:"QR Reader"},c.a.createElement(U.a,null,c.a.createElement(T.a,{size:"xl",level:"2",onClick:function(){m.a.send("VKWebAppOpenCodeReader",{})}},"Open QR reader"),c.a.createElement("div",null,c.a.createElement("ul",null,c.a.createElement("li",null,"qr.dt = ".concat(i.dt)),c.a.createElement("li",null,"qr.sum = ".concat(i.sum)),c.a.createElement("li",null,"qr.fn = ".concat(i.fn)),c.a.createElement("li",null,"qr.i = ".concat(i.i)),c.a.createElement("li",null,"qr.fp = ".concat(i.fp)))))))},N=a(61),Q=a.n(N),Y=a(62),H=a.n(Y),L=function(e){var t=e.id,a=e.go,r=e.fetchedUser,i=Object(n.useState)(""),l=Object(u.a)(i,2),d=l[0],o=l[1],s=Object(n.useState)(""),f=Object(u.a)(s,2),p=f[0],b=f[1],h=Object(E.n)();return Object(n.useEffect)((function(){m.a.subscribe((function(e){var t=e.detail,a=t.type,n=t.data;switch(a){case"VKWebAppGetPersonalCardResult":o(n.email),b(n.phone)}}))}),[]),c.a.createElement(E.j,{id:t},c.a.createElement(E.k,{left:c.a.createElement(E.f,{onClick:a,"data-to":"home"},h===E.g?c.a.createElement(Q.a,null):c.a.createElement(H.a,null))},"\u041f\u0440\u043e\u0444\u0438\u043b\u044c"),r&&c.a.createElement(E.e,{title:r.id},c.a.createElement(E.b,{before:r.photo_200?c.a.createElement(x.a,{src:r.photo_200}):null,description:r.city&&r.city.title?r.city.title:""},"".concat(r.first_name," ").concat(r.last_name))),c.a.createElement(E.d,null,c.a.createElement(E.e,null,c.a.createElement(E.i,null,c.a.createElement(E.b,null,c.a.createElement(E.h,{title:"E-mail"},d||"\u041d\u0435\u043e\u0431\u0445\u043e\u0434\u0438\u043c\u043e \u043f\u043e\u043b\u0443\u0447\u0438\u0442\u044c email")),c.a.createElement(E.b,null,c.a.createElement(E.h,{title:"\u0422\u0435\u043b\u0435\u0444\u043e\u043d"},p||"\u041d\u0435\u043e\u0431\u0445\u043e\u0434\u0438\u043c\u043e \u043f\u043e\u043b\u0443\u0447\u0438\u0442\u044c \u0442\u0435\u043b\u0435\u0444\u043e\u043d")))),c.a.createElement(E.a,{size:"xl",level:"2",onClick:function(){m.a.send("VKWebAppGetPersonalCard",{type:["phone","email"]})}},"\u041f\u043e\u043b\u0443\u0447\u0438\u0442\u044c \u0434\u0430\u043d\u043d\u044b\u0435 \u0438\u0437 VK")))},X=function(e){var t=e.id;return c.a.createElement(E.j,{id:t},c.a.createElement(E.k,{before:c.a.createElement(q.a,null)},"\u0418\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u044f"))},Z=function(e){var t=e.items,a=e.id,n=e.dateTime,r=e.go,i=Object(E.n)(),l=t.map((function(e,t){var a=e.income?e.sum:-1*e.sum;return c.a.createElement(E.e,{title:e.name,key:t},c.a.createElement(E.i,null,e.price?c.a.createElement(I.a,{indicator:F.sum(e.price)},"\u0426\u0435\u043d\u0430"):null,e.quantity?c.a.createElement(I.a,{indicator:e.quantity},"\u041a\u043e\u043b-\u0432\u043e"):null,c.a.createElement(I.a,{indicator:c.a.createElement(G,{sum:a})},"\u0421\u0443\u043c\u043c\u0430")))}));return c.a.createElement(E.j,{id:a},c.a.createElement(E.k,{left:c.a.createElement(E.f,{onClick:r,"data-to":"home"},i===E.g?c.a.createElement(Q.a,null):c.a.createElement(H.a,null))},F.date(n)),l)},$=function(){var e=Object(n.useState)("home"),t=Object(u.a)(e,2),a=t[0],r=t[1],i=Object(n.useState)(null),l=Object(u.a)(i,2),d=l[0],s=l[1],p=Object(n.useState)(c.a.createElement(b.a,{size:"large"})),h=Object(u.a)(p,2),v=h[0],k=h[1],j=Object(n.useState)(""),g=Object(u.a)(j,2),w=g[0],C=g[1],S=Object(n.useState)([{_id:"5ddf911573e0c321bc89f1ef",receipts:[{fn:"9289000100521868",fd:"12691",fp:"339287482"}],userId:"5dce89f495636e23345b7d34",dateTime:"2019-11-12T00:00:00.000",items:[{modifiers:[],properties:[],_id:"5ddf911573e0c321bc89f1f0",name:"test",sum:1e3,income:!0},{modifiers:[],properties:[],_id:"5de8e27933db3f375c2daa20",sum:490,quantity:1,name:"\u041f\u0430\u043a\u0435\u0442-\u043c\u0430\u0439\u043a\u0430 \u041c\u0430\u0433\u043d\u0438\u0442",price:490},{modifiers:[],properties:[],_id:"5de8e27933db3f375c2daa1f",sum:5490,quantity:1,name:"4 \u0421\u0415\u0417\u041e\u041d\u0410 \u0420\u0430\u0433\u0443 \u043e\u0432\u043e\u0449\u043d\u043e\u0435 0,4\u043a\u0433(\u0417\u0430\u043f\u0430\u0434\u043d\u044b\u0439 \u0425\u041a \u041e\u041e\u041e):20",price:5490},{modifiers:[],properties:[],_id:"5de8e27933db3f375c2daa1e",sum:22038,quantity:1.225,name:"\u0421\u043a\u0443\u043c\u0431\u0440\u0438\u044f \u0441/\u043c \u0443\u043f (\u0432\u0435\u0441):6",price:17990},{modifiers:[],properties:[],_id:"5de8e27933db3f375c2daa1d",sum:4490,quantity:1,name:"\u041a\u0420\u0410\u0421\u041a\u0418 \u041b\u0415\u0422\u0410 \u0421\u043e\u0442\u0435 400 \u0433 \u043f/\u0443\u043f(\u0420\u0443\u0441\u0441\u043a\u0430\u044f \u043e\u0432\u043e\u0449\u043d\u0430\u044f \u043a\u043e\u043c\u043f\u0430\u043d\u0438\u044f):8",price:4490},{modifiers:[],properties:[],_id:"5de8e27933db3f375c2daa1c",sum:3490,quantity:1,name:"MR RICCO Organic \u041c\u0430\u0439\u043e\u043d\u0435\u0437 \u043f\u0435\u0440\u0435\u043f \u044f\u0439\u0446\u0430 67% 375\u0433 \u0434/\u043f(\u041d\u044d\u0444\u0438\u0441):12",price:3490},{modifiers:[],properties:[],_id:"5de8e27933db3f375c2daa1b",sum:6490,quantity:1,name:'\u0422\u0432\u043e\u0440\u043e\u0433 \u043e\u0431\u0435\u0437\u0436\u0438\u0440\u0435\u043d\u043d\u044b\u0439 \u0412\u0435\u043c\u043e\u043b 0,5% 0,25\u043a\u0433 \u043a\u043e\u043d\u0442 (\u0417\u0410\u041e "\u0412\u0435\u043c\u043e\u043b") :18',price:6490},{modifiers:[],properties:[],_id:"5de8e27933db3f375c2daa1a",sum:6490,quantity:1,name:"\u0421\u043c\u0435\u0442\u0430\u043d\u0430 15% 0,45\u043a\u0433 \u0444/\u043f (\u041c\u043e\u043b\u043a\u043e\u043c\u0431\u0438\u043d\u0430\u0442 \u041a\u0443\u043d\u0433\u0443\u0440\u0441\u043a\u0438\u0439)",price:6490},{modifiers:[],properties:[],_id:"5de8e27933db3f375c2daa19",sum:7780,quantity:2,name:"\u041c\u043e\u043b\u043e\u043a\u043e \u043f\u0430\u0441\u0442 2,5% 1\u043b \u0444/\u043f (\u041c\u0430\u0421\u041a\u043e):15",price:3890},{modifiers:[],properties:[],_id:"5de8e27933db3f375c2daa18",sum:4790,quantity:1,name:"\u042f\u0439\u0446\u043e \u0441\u0442\u043e\u043b\u043e\u0432\u043e\u0435 \u04211 10\u0448\u0442 \u0431\u043e\u043a\u0441 :20",price:4790}],totalSum:-60548,__v:0},{_id:"5de8d0037a0bbc1cd8169744",receipts:[{fn:"9280440300403604",fd:"8950",fp:"0648032311"}],userId:"5dce89f495636e23345b7d34",dateTime:"2019-11-29T00:00:00.000",totalSum:-3663,items:[{modifiers:[],properties:[],_id:"5de8d0037a0bbc1cd8169746",sum:1063,price:1063,quantity:1,name:"\u0423\u0441\u043b\u0443\u0433\u0430 \u043f\u0438\u0442\u0430\u043d\u0438\u044f"},{modifiers:[],properties:[],_id:"5de8d0037a0bbc1cd8169745",sum:2600,price:2600,quantity:1,name:"\u0423\u0441\u043b\u0443\u0433\u0430 \u043f\u0438\u0442\u0430\u043d\u0438\u044f"}],__v:0},{_id:"5ddf912273e0c321bc89f1f5",receipts:[],userId:"5dce89f495636e23345b7d34",dateTime:"2019-11-15T00:00:00.000",items:[{modifiers:[],properties:[],_id:"5ddf912273e0c321bc89f1f6",name:"test",sum:1e6,income:!0},{modifiers:[],properties:[],_id:"5ddf99d96db8bf32044d2009",name:"test",sum:15e5,income:!0}],totalSum:25e5,__v:0}]),R=Object(u.a)(S,2),T=R[0];R[1];Object(n.useEffect)((function(){m.a.subscribe((function(e){var t=e.detail,a=t.type,n=t.data;switch(a){case"VKWebAppUpdateConfig":var c=document.createAttribute("scheme");c.value=n.scheme?n.scheme:"client_light",document.body.attributes.setNamedItem(c);break;case"VKWebAppOpenCodeReaderResult":C(n.code_data)}})),function(){var e;o.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,o.a.awrap(m.a.sendPromise("VKWebAppGetUserInfo"));case 2:e=t.sent,s(e),k(null);case 5:case"end":return t.stop()}}))}()}),[]);var K=F.qr(w),V=function(e){r(e.currentTarget.dataset.to)};return c.a.createElement(E.c,{activeStory:a,tabbar:c.a.createElement(E.l,null,c.a.createElement(E.m,{selected:"home"===a,onClick:V,"data-to":"home"},c.a.createElement(y.a,null)),c.a.createElement(E.m,{onClick:function(){m.a.send("VKWebAppOpenCodeReader",{})}},c.a.createElement(O.a,{height:28,width:28})),c.a.createElement(E.m,{selected:"profile"===a,onClick:V,"data-to":"profile"},c.a.createElement(_.a,null)),c.a.createElement(E.m,{selected:"info"===a,onClick:V,"data-to":"info"},c.a.createElement(q.a,null)))},c.a.createElement(f.a,{id:"home",activePanel:"home",popout:v},c.a.createElement(M,{id:"home",fetchedUser:d,go:V,qr:K,receipts:T})),c.a.createElement(f.a,{id:"profile",activePanel:"profile",popout:v},c.a.createElement(L,{id:"profile",go:V,fetchedUser:d})),c.a.createElement(f.a,{id:"info",activePanel:"info",popout:v},c.a.createElement(X,{id:"info",go:V})),T.map((function(e,t){return c.a.createElement(f.a,{id:e._id,activePanel:e._id,key:t},c.a.createElement(Z,{id:e._id,dateTime:e.dateTime,items:e.items,go:V}))})))};m.a.send("VKWebAppInit"),i.a.render(c.a.createElement($,null),document.getElementById("root"))}},[[191,1,2]]]);
//# sourceMappingURL=main.29c74ad5.chunk.js.map