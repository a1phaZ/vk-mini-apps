{"version":3,"sources":["handlers/prepare.js","panels/ColoredSum.js","panels/Receipt/index.js","panels/Receipt/receipt.js","panels/AddNote.js","panels/Info.js","contexts/currentUser.js","services/api.js","hooks/useApi.js","panels/Main.js","panels/Main_.js","contexts/appSign.js","handlers/receipts.js","views/Authorization.js","App.js","components/InstallingTheme.js","index.js","hooks/useCompareSign.js"],"names":["Prepare","str","dt","sum","fn","i","fp","match","monthName","Date","getMonth","getDate","getFullYear","n","Intl","NumberFormat","style","currency","format","arr","map","item","totalSum","reduce","previousValue","currentValue","income","reducer","ts","items","ColoredSum","fs","stl","color","fontSize","prepare","Receipt","id","receiptItem","index","key","className","name","price","quantity","AddNote","state","onChange","e","currentTarget","value","checked","type","setState","osname","platform","this","props","go","left","onClick","data-to","IOS","before","top","size","mode","Component","Info","CurrentUserContext","createContext","p","Api","_apiBase","method","uri","body","token","bodyFields","headers","Authorization","fetch","JSON","stringify","res","ok","err","Error","subMessage","json","callApi","url","useState","isLoading","setIsLoading","response","setResponse","error","setError","options","setOptions","apiService","ApiService","doApiFetch","useCallback","useEffect","then","r","catch","Main","useContext","currentUserState","currentDate","dateRange","isLoggedIn","currentUser","useApi","apiResponse","console","log","AppSignContext","password","setPassword","confirmPassword","setConfirmPassword","formError","setFormError","length","header","text","onInput","target","Math","max","parseInt","toString","slice","icon","align","stretched","App","activePanel","setActivePanel","activeView","setPopout","qr","fakeData","apiUser","setCurrentUserState","vkUserId","matchUrlParams","user","dataset","to","InstallingTheme","children","connect","subscribe","detail","data","schemeAttribute","document","createAttribute","scheme","attributes","setNamedItem","send","ReactDOM","render","urlParams","setUrlParams","setVkUserId","setMatch","params","qs","parse","vk_user_id","ordered","Object","keys","sort","forEach","stringParams","paramsHash","crypto","createHmac","update","digest","replace","sign","useCompareSign","setParams","window","location","search","Provider","getElementById"],"mappings":"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","file":"static/js/main.58ad71be.chunk.js","sourcesContent":["export default class Prepare {\r\n\t/**\r\n\t * Преобразование qr кода\r\n\t * @param str\r\n\t * @returns {{dt: *, fn: *, i: *, sum: *, fp: *}}\r\n\t */\r\n\tstatic qr (str){\r\n\t\tlet dt, sum, fn, i, fp;\r\n\r\n\t\tif (str) {\r\n\t\t\t[, dt, sum, fn, i, fp] = str.match(/t=(\\w{8}T\\w+)&s=(\\w+\\.*\\w+)&fn=(\\w+)&i=(\\w+)&fp=(\\w+)/);\r\n\t\t}\r\n\r\n\t\treturn {\r\n\t\t\tdt,\r\n\t\t\tsum,\r\n\t\t\tfn,\r\n\t\t\ti,\r\n\t\t\tfp\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * Преобразование даты\r\n\t * @param str\r\n\t * @returns {string}\r\n\t */\r\n\tstatic date(str) {\r\n\t\tconst dt = new Date(str);\r\n\t\tlet monthName;\r\n\t\tswitch (dt.getMonth() + 1) {\r\n\t\t\tcase 1:\r\n\t\t\t\tmonthName = 'января';\r\n\t\t\t\tbreak;\r\n\t\t\tcase 2:\r\n\t\t\t\tmonthName = 'февраля';\r\n\t\t\t\tbreak;\r\n\t\t\tcase 3:\r\n\t\t\t\tmonthName = 'марта';\r\n\t\t\t\tbreak;\r\n\t\t\tcase 4:\r\n\t\t\t\tmonthName = 'апреля';\r\n\t\t\t\tbreak;\r\n\t\t\tcase 5:\r\n\t\t\t\tmonthName = 'мая';\r\n\t\t\t\tbreak;\r\n\t\t\tcase 6:\r\n\t\t\t\tmonthName = 'июня';\r\n\t\t\t\tbreak;\r\n\t\t\tcase 7:\r\n\t\t\t\tmonthName = 'июля';\r\n\t\t\t\tbreak;\r\n\t\t\tcase 8:\r\n\t\t\t\tmonthName = 'августа';\r\n\t\t\t\tbreak;\r\n\t\t\tcase 9:\r\n\t\t\t\tmonthName = 'сентября';\r\n\t\t\t\tbreak;\r\n\t\t\tcase 10:\r\n\t\t\t\tmonthName = 'октября';\r\n\t\t\t\tbreak;\r\n\t\t\tcase 11:\r\n\t\t\t\tmonthName = 'ноября';\r\n\t\t\t\tbreak;\r\n\t\t\tcase 12:\r\n\t\t\t\tmonthName = 'декабря';\r\n\t\t\t\tbreak;\r\n\t\t\tdefault:\r\n\t\t\t\tbreak;\r\n\t\t}\r\n\t\treturn `${dt.getDate()} ${monthName} ${dt.getFullYear()}`;\r\n\t}\r\n\r\n\t/**\r\n\t * Преобразование суммы\r\n\t * @param n\r\n\t * @returns {string}\r\n\t */\r\n\tstatic sum(n) {\r\n\t\treturn new Intl.NumberFormat('ru-RU', {style: 'currency', currency: 'RUB'}).format(n / 100);\r\n\t}\r\n\r\n\t/**\r\n\t * Расчет общей суммы\r\n\t * @param arr\r\n\t * @returns {number}\r\n\t */\r\n\tstatic totalReceiptSum(arr) {\r\n\t\tconst reducer = (previousValue, currentValue) => previousValue + currentValue;\r\n\t\treturn arr.map((item) => {\r\n\t\t\treturn item.totalSum;\r\n\t\t}).reduce(reducer);\r\n\t}\r\n\r\n\t/**\r\n\t * Подсчет суммарных доходов / расходов\r\n\t * @param arr\r\n\t * @param income\r\n\t * @returns {number}\r\n\t */\r\n\tstatic totalSum(arr, income) {\r\n\t\tconst reducer = (previousValue, currentValue) => previousValue + currentValue;\r\n\t\tconst ts = arr.map(items => {\r\n\t\t\treturn items.items.map(item => {\r\n\t\t\t\tif (income) {\r\n\t\t\t\t\treturn item.income ? item.sum : 0\r\n\t\t\t\t}\r\n\t\t\t\treturn !item.income ? item.sum : 0\r\n\t\t\t}).reduce(reducer)\r\n\t\t}).reduce(reducer);\r\n\t\treturn income ? ts : -1 * ts;\r\n\t}\r\n}","import React from 'react';\r\nimport prepare from \"../handlers/prepare\";\r\n\r\nconst ColoredSum = ({sum, fs}) => {\r\n\tconst stl = sum > 0 ? {color: '#28a745', fontSize: fs} : {color: '#dc3545', fontSize: fs};\r\n\treturn(\r\n\t\t<span style={stl}>{prepare.sum(sum)}</span>\r\n\t)\r\n};\r\n\r\nexport default ColoredSum;\r\n","import Receipt from \"./receipt\";\r\n\r\nexport default Receipt;\r\n","import React from 'react';\r\nimport {Separator} from \"@vkontakte/vkui\";\r\nimport prepare from \"../../handlers/prepare\";\r\nimport ColoredSum from \"../ColoredSum\";\r\n\r\nimport './receipt.css';\r\nimport FormLayout from \"@vkontakte/vkui/dist/components/FormLayout/FormLayout\";\r\n\r\nconst Receipt = ({items, id}) => {\r\n\tconst receiptItem = (items.map((item, index) => {\r\n\t\tconst sum = item.income ? item.sum : (-1) * item.sum ;\r\n\r\n\t\treturn(\r\n\t\t\t<div key={index} className={'receipt-item'}>\r\n\t\t\t\t<span className={'receipt-item-name'}>{item.name}</span>\r\n\t\t\t\t{item.price ? <span>{prepare.sum(item.price)}</span> : null}\r\n\t\t\t\t{item.quantity ? <span>{item.quantity}</span> : null}\r\n\t\t\t\t{sum ? <span>{<ColoredSum sum={sum}/>}</span> : null}\r\n\t\t\t</div>\r\n\t\t)\r\n\t}));\r\n\r\n\treturn(\r\n\t\t<FormLayout id={id}>\r\n\t\t\t<div className={'receipt-item'}>\r\n\t\t\t\t<span className={'receipt-item-name'}>Наименование</span>\r\n\t\t\t\t<span>Цена</span>\r\n\t\t\t\t<span>Кол-во</span>\r\n\t\t\t\t<span>Сумма</span>\r\n\t\t\t</div>\r\n\t\t\t<Separator />\r\n\t\t\t{receiptItem}\r\n\t\t</FormLayout>\r\n\t)\r\n};\r\n\r\nexport default Receipt;","import React, { Component } from 'react';\r\nimport Panel from \"@vkontakte/vkui/dist/components/Panel/Panel\";\r\nimport PanelHeader from '@vkontakte/vkui/dist/components/PanelHeader/PanelHeader';\r\nimport FormLayout from \"@vkontakte/vkui/dist/components/FormLayout/FormLayout\";\r\nimport Input from \"@vkontakte/vkui/dist/components/Input/Input\";\r\nimport PanelHeaderButton from \"@vkontakte/vkui/dist/components/PanelHeaderButton/PanelHeaderButton\";\r\nimport {IOS, platform} from \"@vkontakte/vkui\";\r\nimport Icon24Back from '@vkontakte/icons/dist/24/back';\r\nimport Icon28ChevronBack from '@vkontakte/icons/dist/28/chevron_back';\r\nimport Checkbox from \"@vkontakte/vkui/dist/components/Checkbox/Checkbox\";\r\nimport Button from \"@vkontakte/vkui/dist/components/Button/Button\";\r\nimport Icon24Qr from '@vkontakte/icons/dist/24/qr';\r\nimport PanelHeaderContent from \"@vkontakte/vkui/dist/components/PanelHeaderContent/PanelHeaderContent\";\r\n\r\nexport default class AddNote extends Component {\r\n  state = {\r\n    name: '',\r\n    quantity: 1,\r\n    price: 0,\r\n    sum: 0,\r\n    income: false\r\n  };\r\n\r\n  onChange = (e) => {\r\n    const { name, value, checked, type } = e.currentTarget;\r\n    if (type !== 'checkbox') {\r\n      this.setState({ [name]: value });\r\n    } else {\r\n      this.setState({ [name]: checked });\r\n    }\r\n  };\r\n\r\n  render() {\r\n    const osname = platform();\r\n    const {id, go} = this.props;\r\n    return(\r\n      <Panel id={id}>\r\n        <PanelHeader\r\n          left={\r\n            <PanelHeaderButton key={'back'} onClick={go} data-to={'balance'}>{osname === IOS ? <Icon28ChevronBack/> : <Icon24Back/>}</PanelHeaderButton>\r\n          }\r\n        >\r\n          <PanelHeaderContent\r\n            before={<PanelHeaderButton key={'qr'}><Icon24Qr /></PanelHeaderButton>}\r\n          >\r\n            Добавление записи\r\n          </PanelHeaderContent>\r\n        </PanelHeader>\r\n        <FormLayout>\r\n          <Input\r\n            type={'text'}\r\n            top={'Название'}\r\n            name={'name'}\r\n            value={this.state.name}\r\n            onChange={this.onChange}\r\n          />\r\n          <Input\r\n            type={'number'}\r\n            top={'Количество'}\r\n            name={'quantity'}\r\n            value={this.state.quantity}\r\n            onChange={this.onChange}\r\n          />\r\n          <Input\r\n            type={'number'}\r\n            top={'Цена'}\r\n            name={'price'}\r\n            value={this.state.price}\r\n            onChange={this.onChange}\r\n          />\r\n          <Checkbox\r\n            name={'income'}\r\n            value={this.state.income}\r\n            onChange={this.onChange}\r\n          >Доход</Checkbox>\r\n\r\n          <Button size=\"xl\" mode={this.state.income ? \"commerce\" : \"destructive\"}>\r\n            Добавить {this.state.income ? \"доход\" : \"расход\"}\r\n          </Button>\r\n        </FormLayout>\r\n      </Panel>\r\n    )\r\n  }\r\n}","import React from 'react';\r\nimport {Panel, PanelHeader} from '@vkontakte/vkui';\r\nimport Icon28InfoOutline from '@vkontakte/icons/dist/28/info_outline';\r\n\r\nconst Info = ({id}) => {\r\n\treturn (\r\n\t\t<Panel id={id}>\r\n\t\t\t<PanelHeader before={<Icon28InfoOutline />}>Информация</PanelHeader>\r\n\t\t</Panel>\r\n\t)\r\n};\r\n\r\nexport default Info;","import React, { createContext, useState } from 'react';\r\n\r\nexport const CurrentUserContext = createContext([{}, p => {}]);\r\n\r\nexport const CurrentUserProvider = ({ children }) => {\r\n\tconst [state, setState] = useState({\r\n\t\tisLoading: false,\r\n\t\tisLoggedIn: null,\r\n\t\tcurrentUser: null\r\n\t});\r\n\treturn (\r\n\t\t<CurrentUserContext.Provider value={[state, setState]}>\r\n\t\t\t{children}\r\n\t\t</CurrentUserContext.Provider>\r\n\t)\r\n};\r\n","export default class Api {\r\n  _apiBase = `http://localhost:3000/api`;\r\n\r\n  async callApi(method, uri, body) {\r\n    const { token, ...bodyFields} = body;\r\n    const headers = {\r\n      'Content-Type': 'application/json',\r\n      Authorization: token ? `Token ${token}` : '',\r\n    };\r\n    const res = await fetch(`${this._apiBase}${uri}`, {\r\n      method,\r\n      mode: 'cors',\r\n      headers,\r\n      body: method !== 'GET' ? JSON.stringify(bodyFields) : null,\r\n    });\r\n\r\n    if (!res.ok) {\r\n      const err = new Error(`Ошибка Авторизации`);\r\n      err.subMessage = 'Неверное имя пользователя или пароль';\r\n      throw err;\r\n    }\r\n\r\n    return await res.json();\r\n  }\r\n\r\n  //TODO Дописать вызов api\r\n  /**\r\n   * User api\r\n   */\r\n  async userLogin(body) {\r\n    return await this.callApi('POST', '/users/login', body);\r\n  }\r\n\r\n  async userRegister(body) {\r\n    return await this.callApi('POST', '/users', body);\r\n  }\r\n\r\n  async userCurrent(body) {\r\n    return await this.callApi('GET', '/users/current', body);\r\n  }\r\n\r\n  async userUpdate(body) {\r\n    return await this.callApi('PUT', '/users/current', body);\r\n  }\r\n}\r\n","import {useState, useEffect, useCallback} from 'react';\r\nimport ApiService from '../services/api';\r\n\r\nexport default url => {\r\n\tconst [isLoading, setIsLoading] = useState(false);\r\n\tconst [response, setResponse] = useState(null);\r\n\tconst [error, setError] = useState(null);\r\n\tconst [options, setOptions] = useState({});\r\n\tconst apiService = new ApiService();\r\n\r\n\tconst doApiFetch = useCallback((options) => {\r\n\t\tsetOptions(options);\r\n\t\tsetIsLoading(true);\r\n\t}, []);\r\n\r\n\tconst { method, token, ...bodyFields} = options;\r\n\tuseEffect(() => {\r\n\t\tif (!isLoading) {\r\n\t\t\treturn\r\n\t\t}\r\n\r\n\t\tapiService.callApi(method, url, bodyFields)\r\n\t\t\t.then(r => {\r\n\t\t\t\tsetResponse(r);\r\n\t\t\t\tsetIsLoading(false);\r\n\t\t\t})\r\n\t\t\t.catch(e => {\r\n\t\t\t\tsetError(e);\r\n\t\t\t\tsetIsLoading(false);\r\n\t\t\t});\r\n\r\n\r\n\t}, [isLoading, apiService, bodyFields, method, url]);\r\n\treturn [{isLoading, response, error}, doApiFetch];\r\n}\r\n","import React, {useState, useEffect, useContext} from 'react';\r\nimport {CurrentUserContext} from \"../contexts/currentUser\";\r\nimport useApi from \"../hooks/useApi\";\r\n\r\nconst Main = () => {\r\n\tconst [currentUserState] = useContext(CurrentUserContext);\r\n\tconst currentDate = new Date();\r\n\tconst [dateRange, setDateRange] = useState([\r\n\t\tnew Date(currentDate.getFullYear(), currentDate.getMonth(), 1),\r\n\t\tnew Date(currentDate.getFullYear(), currentDate.getMonth()+1, 0),\r\n\t]);\r\n\tconst [receipts, setReceipts] = useState([]);\r\n\tconst {isLoading, isLoggedIn,\tcurrentUser} = currentUserState;\r\n\tconst [apiResponse, doApiFetch] = useApi('/day');\r\n\r\n\tconsole.log({currentUser});\r\n\tconsole.log({dateRange});\r\n\r\n\tuseEffect(() => {\r\n\t\tif (!currentUser || !isLoggedIn) return;\r\n\t\tdoApiFetch({\r\n\t\t\tmethod: 'GET'\r\n\t\t});\r\n\t\tconsole.log(apiResponse);\r\n\r\n\t}, [currentUser, isLoggedIn]);\r\n\r\n\treturn(\r\n\t\t<div>Main</div>\r\n\t)\r\n};\r\n\r\nexport default Main;\r\n","import React, {Component} from 'react';\r\nimport {\r\n\tList,\r\n\tModalPage,\r\n\tModalRoot,\r\n\tModalPageHeader,\r\n\tIOS,\r\n\tplatform, Placeholder, Separator\r\n} from '@vkontakte/vkui';\r\nimport Panel from '@vkontakte/vkui/dist/components/Panel/Panel';\r\nimport PanelHeader from '@vkontakte/vkui/dist/components/PanelHeader/PanelHeader';\r\nimport Button from '@vkontakte/vkui/dist/components/Button/Button';\r\nimport Group from '@vkontakte/vkui/dist/components/Group/Group';\r\nimport Cell from '@vkontakte/vkui/dist/components/Cell/Cell';\r\nimport prepare from \"../handlers/prepare\";\r\nimport ColoredSum from \"./ColoredSum\";\r\nimport View from \"@vkontakte/vkui/dist/components/View/View\";\r\nimport Receipt from \"./Receipt\";\r\nimport Icon24Cancel from '@vkontakte/icons/dist/24/cancel';\r\nimport Icon24Dismiss from '@vkontakte/icons/dist/24/dismiss';\r\nimport PanelHeaderButton from \"@vkontakte/vkui/dist/components/PanelHeaderButton/PanelHeaderButton\";\r\nimport Icon56GoodsCollection from '@vkontakte/icons/dist/56/goods_collection';\r\nimport Icon16Up from '@vkontakte/icons/dist/16/up';\r\nimport Icon16Down from '@vkontakte/icons/dist/16/down';\r\nimport AddNote from \"./AddNote\";\r\nimport Info from \"./Info\";\r\nimport Main from \"./Main\";\r\n\r\nexport default class Main_ extends Component {\r\n\tstate = {\r\n\t\tactiveModal: null,\r\n\t\tmodalHistory: [],\r\n\t};\r\n\r\n\tmodalBack = () => {\r\n\t\tthis.setActiveModal(this.state.modalHistory[this.state.modalHistory.length - 2]);\r\n\t};\r\n\r\n\tsetActiveModal = (activeModal) => {\r\n\r\n\t\tactiveModal = activeModal || null;\r\n\t\tlet modalHistory = this.state.modalHistory ? [...this.state.modalHistory] : [];\r\n\r\n\t\tif (activeModal === null) {\r\n\t\t\tmodalHistory = [];\r\n\t\t} else if (modalHistory.indexOf(activeModal) !== -1) {\r\n\t\t\tmodalHistory = modalHistory.splice(0, modalHistory.indexOf(activeModal)+1);\r\n\t\t} else {\r\n\t\t\tmodalHistory.push(activeModal);\r\n\t\t}\r\n\r\n\t\tthis.setState({\r\n\t\t\tactiveModal,\r\n\t\t\tmodalHistory\r\n\t\t});\r\n\t};\r\n\r\n\trender() {\r\n\t\tconst { receipts, fetchedUser, qr, go, popout, id} = this.props;\r\n\t\tconst osName = platform();\r\n\t\tconst modal = (\r\n\t\t\t<ModalRoot activeModal={this.state.activeModal}>\r\n\t\t\t\t{receipts.map((receipt, index) => {\r\n\t\t\t\t\treturn(\r\n\t\t\t\t\t\t<ModalPage\r\n\t\t\t\t\t\t\tkey={index}\r\n\t\t\t\t\t\t\tid={receipt._id}\r\n\t\t\t\t\t\t\tonClose={this.modalBack}\r\n\t\t\t\t\t\t\theader={\r\n\t\t\t\t\t\t\t\t<ModalPageHeader\r\n\t\t\t\t\t\t\t\t\tleft={osName !== IOS && <PanelHeaderButton onClick={this.modalBack}><Icon24Cancel /></PanelHeaderButton>}\r\n\t\t\t\t\t\t\t\t\tright={osName === IOS && <PanelHeaderButton onClick={this.modalBack}>{osName === IOS ? 'Готово' : <Icon24Dismiss />}</PanelHeaderButton>}\r\n\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t{prepare.date(receipt.dateTime)}\r\n\t\t\t\t\t\t\t\t</ModalPageHeader>\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t<List>\r\n\t\t\t\t\t\t\t\t<Receipt id={receipt._id} dateTime={receipt.dateTime} items={receipt.items}/>\r\n\t\t\t\t\t\t\t</List>\r\n\t\t\t\t\t\t</ModalPage>\r\n\t\t\t\t\t)\r\n\t\t\t\t})}\r\n\t\t\t</ModalRoot>\r\n\t\t);\r\n\r\n\t\treturn (\r\n\t\t\t<View id={'home'} activePanel={id} popout={popout} modal={modal}>\r\n\t\t\t\t<Panel id={'balance'}>\r\n\t\t\t\t\t<PanelHeader>Balance</PanelHeader>\r\n\t\t\t\t\t<Placeholder\r\n\t\t\t\t\t\ticon={<Icon56GoodsCollection />}\r\n\t\t\t\t\t\theader={<ColoredSum sum={prepare.totalReceiptSum(receipts)} fs={'2em'}/>}\r\n\t\t\t\t\t\taction={<Button size=\"l\" onClick={go} data-to={'addnote'}>Добавить доход / расход</Button>}\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\tДобавляйте доходы/расходы\r\n\t\t\t\t\t</Placeholder>\r\n\t\t\t\t\t<Separator/>\r\n\t\t\t\t\t<Main />\r\n\t\t\t\t\t<div style={{\r\n\t\t\t\t\t\tdisplay: 'flex',\r\n\t\t\t\t\t\tflexDirection: 'row',\r\n\t\t\t\t\t\tjustifyContent: 'space-between',\r\n\t\t\t\t\t\tpaddingTop: '1em',\r\n\t\t\t\t\t}}>\r\n\t\t\t\t\t\t<div style={{flex: '0 1 50%', display: 'flex',justifyContent: 'flex-end',}}>\r\n\t\t\t\t\t\t\t<div style={{display: 'flex', flexDirection: 'column', paddingRight: '10px'}}>\r\n\t\t\t\t\t\t\t\t<span style={{color: '#6F6F6F', fontSize: '0.7em', textAlign: 'end'}}>Доходы</span>\r\n\t\t\t\t\t\t\t\t<ColoredSum sum={prepare.totalSum(receipts, true)} fs={'1.4em'}/>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t<Icon16Up width={16} height={40} fill={'#28a745'}/>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t<div style={{flex: '0 1 50%', display: 'flex',justifyContent: 'flex-start',}}>\r\n\t\t\t\t\t\t\t<Icon16Down width={16} height={40} fill={'#dc3545'}/>\r\n\t\t\t\t\t\t\t<div style={{display: 'flex', flexDirection: 'column', paddingLeft: '10px'}}>\r\n\t\t\t\t\t\t\t\t<span style={{color: '#6F6F6F', fontSize: '0.7em'}}>Расходы</span>\r\n\t\t\t\t\t\t\t\t<ColoredSum sum={prepare.totalSum(receipts, false)} fs={'1.4em'}/>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t<Group title='Чеки'>\r\n\t\t\t\t\t\t<List>\r\n\t\t\t\t\t\t\t{receipts.map((receipt, index) => {\r\n\t\t\t\t\t\t\t\treturn (\r\n\t\t\t\t\t\t\t\t\t<Cell\r\n\t\t\t\t\t\t\t\t\t\tkey={index}\r\n\t\t\t\t\t\t\t\t\t\texpandable\r\n\t\t\t\t\t\t\t\t\t\tonClick={(e) => this.setActiveModal(e.currentTarget.dataset.to)}\r\n\t\t\t\t\t\t\t\t\t\tdata-to={receipt._id}\r\n\t\t\t\t\t\t\t\t\t\tindicator={<ColoredSum sum={receipt.totalSum}/>}\r\n\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t{prepare.date(receipt.dateTime)}\r\n\t\t\t\t\t\t\t\t\t</Cell>\r\n\t\t\t\t\t\t\t\t)\r\n\t\t\t\t\t\t\t})}\r\n\t\t\t\t\t\t</List>\r\n\t\t\t\t\t</Group>\r\n\t\t\t\t</Panel>\r\n\t\t\t\t<AddNote id={'addnote'} go={go}/>\r\n\t\t\t\t<Info id={'info'} />\r\n\t\t\t</View>\r\n\t\t)\r\n\t}\r\n\r\n}","import React, { useState, createContext, useEffect } from 'react';\r\nimport useCompareSign from \"../hooks/useCompareSign\";\r\n\r\nexport const AppSignContext = createContext([{}, () => {}]);\r\n\r\nexport const AppSignProvider = ({ children }) => {\r\n  const [{vkUserId, matchUrlParams}, setParams] = useCompareSign();\r\n  const [state, setState] = useState({\r\n    vkUserId: null,\r\n    matchUrlParams: false\r\n  });\r\n\r\n  useEffect(()=>{\r\n    setParams(window.location.search.slice(1));\r\n  }, [setParams]);\r\n\r\n  useEffect(() => {\r\n    if (!vkUserId) return;\r\n    setState({vkUserId, matchUrlParams});\r\n  }, [vkUserId, matchUrlParams]);\r\n\r\n  return (\r\n    <AppSignContext.Provider value={[state, setState]}>\r\n      {children}\r\n    </AppSignContext.Provider>\r\n  )\r\n};","export default [\r\n  {\r\n    \"_id\" : \"5ddf911573e0c321bc89f1ef\",\r\n    \"receipts\" : [\r\n      {\r\n        \"fn\" : \"9289000100521868\",\r\n        \"fd\" : \"12691\",\r\n        \"fp\" : \"339287482\"\r\n      }\r\n    ],\r\n    \"userId\" : \"5dce89f495636e23345b7d34\",\r\n    \"dateTime\" : \"2019-11-12T00:00:00.000\",\r\n    \"items\" : [\r\n      {\r\n        \"modifiers\" : [],\r\n        \"properties\" : [],\r\n        \"_id\" : \"5ddf911573e0c321bc89f1f0\",\r\n        \"name\" : \"test\",\r\n        \"sum\" : 1000,\r\n        \"income\" : true\r\n      },\r\n      {\r\n        \"modifiers\" : [],\r\n        \"properties\" : [],\r\n        \"_id\" : \"5de8e27933db3f375c2daa20\",\r\n        \"sum\" : 490,\r\n        \"quantity\" : 1,\r\n        \"name\" : \"Пакет-майка Магнит\",\r\n        \"price\" : 490\r\n      },\r\n      {\r\n        \"modifiers\" : [],\r\n        \"properties\" : [],\r\n        \"_id\" : \"5de8e27933db3f375c2daa1f\",\r\n        \"sum\" : 5490,\r\n        \"quantity\" : 1,\r\n        \"name\" : \"4 СЕЗОНА Рагу овощное 0,4кг(Западный ХК ООО):20\",\r\n        \"price\" : 5490\r\n      },\r\n      {\r\n        \"modifiers\" : [],\r\n        \"properties\" : [],\r\n        \"_id\" : \"5de8e27933db3f375c2daa1e\",\r\n        \"sum\" : 22038,\r\n        \"quantity\" : 1.225,\r\n        \"name\" : \"Скумбрия с/м уп (вес):6\",\r\n        \"price\" : 17990\r\n      },\r\n      {\r\n        \"modifiers\" : [],\r\n        \"properties\" : [],\r\n        \"_id\" : \"5de8e27933db3f375c2daa1d\",\r\n        \"sum\" : 4490,\r\n        \"quantity\" : 1,\r\n        \"name\" : \"КРАСКИ ЛЕТА Соте 400 г п/уп(Русская овощная компания):8\",\r\n        \"price\" : 4490\r\n      },\r\n      {\r\n        \"modifiers\" : [],\r\n        \"properties\" : [],\r\n        \"_id\" : \"5de8e27933db3f375c2daa1c\",\r\n        \"sum\" : 3490,\r\n        \"quantity\" : 1,\r\n        \"name\" : \"MR RICCO Organic Майонез переп яйца 67% 375г д/п(Нэфис):12\",\r\n        \"price\" : 3490\r\n      },\r\n      {\r\n        \"modifiers\" : [],\r\n        \"properties\" : [],\r\n        \"_id\" : \"5de8e27933db3f375c2daa1b\",\r\n        \"sum\" : 6490,\r\n        \"quantity\" : 1,\r\n        \"name\" : \"Творог обезжиренный Вемол 0,5% 0,25кг конт (ЗАО \\\"Вемол\\\") :18\",\r\n        \"price\" : 6490\r\n      },\r\n      {\r\n        \"modifiers\" : [],\r\n        \"properties\" : [],\r\n        \"_id\" : \"5de8e27933db3f375c2daa1a\",\r\n        \"sum\" : 6490,\r\n        \"quantity\" : 1,\r\n        \"name\" : \"Сметана 15% 0,45кг ф/п (Молкомбинат Кунгурский)\",\r\n        \"price\" : 6490\r\n      },\r\n      {\r\n        \"modifiers\" : [],\r\n        \"properties\" : [],\r\n        \"_id\" : \"5de8e27933db3f375c2daa19\",\r\n        \"sum\" : 7780,\r\n        \"quantity\" : 2,\r\n        \"name\" : \"Молоко паст 2,5% 1л ф/п (МаСКо):15\",\r\n        \"price\" : 3890\r\n      },\r\n      {\r\n        \"modifiers\" : [],\r\n        \"properties\" : [],\r\n        \"_id\" : \"5de8e27933db3f375c2daa18\",\r\n        \"sum\" : 4790,\r\n        \"quantity\" : 1,\r\n        \"name\" : \"Яйцо столовое С1 10шт бокс :20\",\r\n        \"price\" : 4790\r\n      }\r\n    ],\r\n    \"totalSum\" : -60548,\r\n    \"__v\" : 0\r\n  },\r\n  {\r\n    \"_id\" : \"5de8d0037a0bbc1cd8169744\",\r\n    \"receipts\" : [\r\n      {\r\n        \"fn\" : \"9280440300403604\",\r\n        \"fd\" : \"8950\",\r\n        \"fp\" : \"0648032311\"\r\n      }\r\n    ],\r\n    \"userId\" : \"5dce89f495636e23345b7d34\",\r\n    \"dateTime\" : \"2019-11-29T00:00:00.000\",\r\n    \"totalSum\" : -3663,\r\n    \"items\" : [\r\n      {\r\n        \"modifiers\" : [],\r\n        \"properties\" : [],\r\n        \"_id\" : \"5de8d0037a0bbc1cd8169746\",\r\n        \"sum\" : 1063,\r\n        \"price\" : 1063,\r\n        \"quantity\" : 1,\r\n        \"name\" : \"Услуга питания\"\r\n      },\r\n      {\r\n        \"modifiers\" : [],\r\n        \"properties\" : [],\r\n        \"_id\" : \"5de8d0037a0bbc1cd8169745\",\r\n        \"sum\" : 2600,\r\n        \"price\" : 2600,\r\n        \"quantity\" : 1,\r\n        \"name\" : \"Услуга питания\"\r\n      }\r\n    ],\r\n    \"__v\" : 0\r\n  },\r\n  {\r\n    \"_id\" : \"5ddf912273e0c321bc89f1f5\",\r\n    \"receipts\" : [],\r\n    \"userId\" : \"5dce89f495636e23345b7d34\",\r\n    \"dateTime\" : \"2019-11-15T00:00:00.000\",\r\n    \"items\" : [\r\n      {\r\n        \"modifiers\" : [],\r\n        \"properties\" : [],\r\n        \"_id\" : \"5ddf912273e0c321bc89f1f6\",\r\n        \"name\" : \"test\",\r\n        \"sum\" : 1000000,\r\n        \"income\" : true\r\n      },\r\n      {\r\n        \"modifiers\" : [],\r\n        \"properties\" : [],\r\n        \"_id\" : \"5ddf99d96db8bf32044d2009\",\r\n        \"name\" : \"test\",\r\n        \"sum\" : 1500000,\r\n        \"income\" : true\r\n      }\r\n    ],\r\n    \"totalSum\" : 2500000,\r\n    \"__v\" : 0\r\n  },\r\n  {\r\n    \"_id\" : \"5ddf912273e0c321bc89f1f6\",\r\n    \"receipts\" : [],\r\n    \"userId\" : \"5dce89f495636e23345b7d34\",\r\n    \"dateTime\" : \"2020-02-09T14:16:00\",\r\n    \"items\": [\r\n      {\r\n        \"price\": 590,\r\n        \"properties\": [],\r\n        \"sum\": 590,\r\n        \"name\": \"Пакет-майка Магнит\",\r\n        \"quantity\": 1,\r\n        \"modifiers\": []\r\n      },\r\n      {\r\n        \"price\": 6292,\r\n        \"properties\": [],\r\n        \"sum\": 881,\r\n        \"name\": \"ЯБЛОКИ новый урожай 1кг\",\r\n        \"quantity\": 0.14,\r\n        \"modifiers\": []\r\n      },\r\n      {\r\n        \"price\": 6291,\r\n        \"properties\": [],\r\n        \"sum\": 10821,\r\n        \"name\": \"ЯБЛОКИ новый урожай 1кг\",\r\n        \"quantity\": 1.72,\r\n        \"modifiers\": []\r\n      },\r\n      {\r\n        \"price\": 32447,\r\n        \"properties\": [],\r\n        \"sum\": 16483,\r\n        \"name\": \"АВОКАДО 1кг\",\r\n        \"quantity\": 0.508,\r\n        \"modifiers\": []\r\n      },\r\n      {\r\n        \"price\": 14832,\r\n        \"properties\": [],\r\n        \"sum\": 2907,\r\n        \"name\": \"ОГУРЦЫ гладкие 1кг\",\r\n        \"quantity\": 0.196,\r\n        \"modifiers\": []\r\n      },\r\n      {\r\n        \"price\": 14831,\r\n        \"properties\": [],\r\n        \"sum\": 9610,\r\n        \"name\": \"ОГУРЦЫ гладкие 1кг\",\r\n        \"quantity\": 0.648,\r\n        \"modifiers\": []\r\n      },\r\n      {\r\n        \"price\": 4490,\r\n        \"properties\": [],\r\n        \"sum\": 8980,\r\n        \"name\": \"СИБИРСКАЯ ЯГОДА Протерт Земляника0,2\",\r\n        \"quantity\": 2,\r\n        \"modifiers\": []\r\n      },\r\n      {\r\n        \"price\": 4240,\r\n        \"properties\": [],\r\n        \"sum\": 8480,\r\n        \"name\": \"Молоко паст 2,5% 1л ф/п (Нытвенский\",\r\n        \"quantity\": 2,\r\n        \"modifiers\": []\r\n      },\r\n      {\r\n        \"price\": 1590,\r\n        \"properties\": [],\r\n        \"sum\": 1590,\r\n        \"name\": \"САДЫ ПРИДОНЬЯ Сок яблоко персик 0,2л\",\r\n        \"quantity\": 1,\r\n        \"modifiers\": []\r\n      },\r\n      {\r\n        \"price\": 1590,\r\n        \"properties\": [],\r\n        \"sum\": 1590,\r\n        \"name\": \"САДЫ ПРИДОНЬЯ Сок мультифруктовый 0,\",\r\n        \"quantity\": 1,\r\n        \"modifiers\": []\r\n      }\r\n    ],\r\n    \"totalSum\" : -61932,\r\n    \"__v\" : 0\r\n  }\r\n];","import React, {Fragment, useState, useEffect} from 'react';\r\nimport {Div, FormLayout, FormLayoutGroup, Input, Placeholder, FormStatus} from \"@vkontakte/vkui\";\r\nimport PanelHeader from \"@vkontakte/vkui/dist/components/PanelHeader/PanelHeader\";\r\nimport Button from \"@vkontakte/vkui/dist/components/Button/Button\";\r\nimport Icon56LockOutline from '@vkontakte/icons/dist/56/lock_outline';\r\nimport Icon56UserAddOutline from '@vkontakte/icons/dist/56/user_add_outline';\r\n\r\nconst Authorization = ({go, type}) => {\r\n\tconst [password, setPassword] = useState('');\r\n\tconst [confirmPassword, setConfirmPassword] = useState('');\r\n\tconst [formError, setFormError] = useState(null);\r\n\r\n\tuseEffect(()=>{\r\n\t\tif (password.length !== confirmPassword.length) {\r\n\t\t\tsetFormError(null);\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tif (password !== confirmPassword) {\r\n\t\t\tsetFormError({header: 'Пароли не совпадают', text: 'Для продолжнения пароли должны совпадать'});\r\n\t\t}\r\n\t}, [password, confirmPassword]);\r\n\r\n\tconst onInput = (e) => {\r\n\t\te.target.value = Math.max(0, parseInt(e.target.value) ).toString().slice(0,4);\r\n\t\tif (e.target.name === 'password') {\r\n\t\t\tsetPassword(e.target.value);\r\n\t\t} else {\r\n\t\t\tsetConfirmPassword(e.target.value);\r\n\t\t}\r\n\t};\r\n\r\n\tconst formStatus = () => {\r\n\t\tif (!formError) return null;\r\n\t\treturn (\r\n\t\t\t<FormStatus header={formError.header} mode=\"error\">\r\n\t\t\t\t{formError.text}\r\n\t\t\t</FormStatus>\r\n\t\t)\r\n\t};\r\n\r\n\treturn (\r\n\t\t<Fragment>\r\n\t\t\t<PanelHeader>{type === 'login' ? 'Авторизация' : 'Регистрация'}</PanelHeader>\r\n\t\t\t<Placeholder\r\n\t\t\t\ticon={type === 'login' ? <Icon56LockOutline /> : <Icon56UserAddOutline />}\r\n\t\t\t\theader={type === 'login' ? 'Введите пароль' : 'Придумайте пароль'}\r\n\t\t\t>\r\n\t\t\t\t<FormLayout>\r\n\t\t\t\t\t{formStatus()}\r\n\t\t\t\t\t<FormLayoutGroup top={'Введите пароль'}>\r\n\t\t\t\t\t\t<Input name={'password'} type={'number'} onChange = {onInput} align=\"center\" value={password}/>\r\n\t\t\t\t\t</FormLayoutGroup>\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\ttype !== 'login'\r\n\t\t\t\t\t\t\t?\r\n\t\t\t\t\t\t\t<FormLayoutGroup top={'Повторите пароль'}>\r\n\t\t\t\t\t\t\t\t<Input type={'number'} name={'confirmPassword'} onChange = {onInput} align=\"center\" value={confirmPassword}/>\r\n\t\t\t\t\t\t\t</FormLayoutGroup>\r\n\t\t\t\t\t\t\t:\r\n\t\t\t\t\t\tnull\r\n\t\t\t\t\t}\r\n\t\t\t\t\t<Button size=\"l\">{type === 'login' ? 'Авторизация' : 'Регистрация'}</Button>\r\n\t\t\t\t</FormLayout>\r\n\t\t\t</Placeholder>\r\n\t\t\t<Div>\r\n\t\t\t\t<Button\r\n\t\t\t\t\tstretched\r\n\t\t\t\t\tmode=\"tertiary\"\r\n\t\t\t\t\tonClick={go}\r\n\t\t\t\t\tdata-to={type === 'login' ? 'authorization.registration' : 'authorization.login'}\r\n\t\t\t\t>{type === 'login' ? 'Нет пароля?' : 'Есть пароль?'}</Button>\r\n\t\t\t</Div>\r\n\t\t</Fragment>\r\n\t)\r\n};\r\n\r\nexport default Authorization;\r\n","import React, { useState, useEffect, useContext } from 'react';\r\nimport connect from '@vkontakte/vk-connect';\r\nimport ScreenSpinner from '@vkontakte/vkui/dist/components/ScreenSpinner/ScreenSpinner';\r\nimport '@vkontakte/vkui/dist/vkui.css';\r\nimport prepare from \"./handlers/prepare\";\r\nimport Main_ from \"./panels/Main_\";\r\nimport useApi from \"./hooks/useApi\";\r\nimport {CurrentUserContext} from \"./contexts/currentUser\";\r\nimport {AppSignContext} from \"./contexts/appSign\";\r\nimport fakeData from './handlers/receipts';\r\nimport {Placeholder, Root, Panel, View, FormLayout, FormLayoutGroup, Input, Div} from \"@vkontakte/vkui\";\r\nimport PanelHeader from \"@vkontakte/vkui/dist/components/PanelHeader/PanelHeader\";\r\nimport ColoredSum from \"./panels/ColoredSum\";\r\nimport Button from \"@vkontakte/vkui/dist/components/Button/Button\";\r\nimport Authorization from \"./views/Authorization\";\r\n\r\n\r\nconst App = () => {\r\n\tconst [activePanel, setActivePanel] = useState('authorization.login');\r\n\tconst [activeView, setActiveView] = useState('authorization');\r\n\tconst [popout, setPopout] = useState(<ScreenSpinner size='large' />);\r\n\tconst [qr, setQR] = useState('');\r\n\tconst [receipts] = useState(fakeData);\r\n\tconst [apiUser, doApiFetch] = useApi('/users');\r\n\tconst [currentUserState, setCurrentUserState] = useContext(CurrentUserContext);\r\n\tconst [{vkUserId, matchUrlParams}] = useContext(AppSignContext);\r\n\r\n\tconsole.log({vkUserId, matchUrlParams});\r\n\r\n\r\n\tuseEffect(() => {\r\n\t\tif (!vkUserId) return;\r\n\t\tdoApiFetch({\r\n\t\t\tmethod: 'POST',\r\n\t\t\tuser: {\r\n\t\t\t\tid: +vkUserId\r\n\t\t\t}\r\n\t\t});\r\n\t\tsetPopout(null);\r\n\t}, [vkUserId, doApiFetch]);\r\n\r\n\tuseEffect(() => {\r\n\t\tif (!apiUser.response) return;\r\n\r\n\t\tsetCurrentUserState(state => ({\r\n\t\t\t...state,\r\n\t\t\tisLoading: false,\r\n\t\t\tisLoggedIn: true,\r\n\t\t\tcurrentUser: apiUser.response.user\r\n\t\t}))\r\n\t}, [apiUser.response, setCurrentUserState]);\r\n\r\n\tconst QR = prepare.qr(qr);\r\n\r\n\tconst go = e => {\r\n\t\tsetActivePanel(e.currentTarget.dataset.to);\r\n\t};\r\n\r\n\tconst changeActiveView = e => {\r\n\t\tsetActiveView(e.currentTarget.dataset.to);\r\n\t};\r\n\r\n\tconsole.log({currentUserState});\r\n\treturn (\r\n\t\t<Root activeView={activeView}>\r\n\t\t\t<View id={'authorization'} activePanel={activePanel}>\r\n\t\t\t\t<Panel id={'authorization.login'}>\r\n\t\t\t\t\t<Authorization go={go} type={'login'}/>\r\n\t\t\t\t</Panel>\r\n\t\t\t\t<Panel id={'authorization.registration'}>\r\n\t\t\t\t\t<Authorization go={go} type={'registration'}/>\r\n\t\t\t\t</Panel>\r\n\t\t\t</View>\r\n\t\t</Root>\r\n\t);\r\n};\r\n\r\nexport default App;\r\n","import React, { useEffect } from 'react';\r\nimport connect from \"@vkontakte/vk-connect\";\r\n\r\nconst InstallingTheme = ({ children }) => {\r\n\r\n\tuseEffect(() => {\r\n\t\tconnect.subscribe(({ detail: { type, data }}) => {\r\n\t\t\tif (type === 'VKWebAppUpdateConfig') {\r\n\t\t\t\tconst schemeAttribute = document.createAttribute('scheme');\r\n\t\t\t\tschemeAttribute.value = data.scheme ? data.scheme : 'client_light';\r\n\t\t\t\tdocument.body.attributes.setNamedItem(schemeAttribute);\r\n\t\t\t}\r\n\t\t});\r\n\t}, []);\r\n\r\n\treturn (children)\r\n};\r\n\r\nexport default InstallingTheme;\r\n","import 'core-js/features/map';\r\nimport 'core-js/features/set';\r\nimport React from 'react';\r\nimport ReactDOM from 'react-dom';\r\nimport connect from '@vkontakte/vk-connect';\r\nimport App from './App';\r\nimport {CurrentUserProvider} from \"./contexts/currentUser\";\r\nimport {AppSignProvider} from \"./contexts/appSign\";\r\nimport InstallingTheme from \"./components/InstallingTheme\";\r\n// import registerServiceWorker from './sw';\r\n\r\n// Init VK  Mini App\r\nconnect.send('VKWebAppInit');\r\n\r\n// Если вы хотите, чтобы ваше веб-приложение работало в оффлайне и загружалось быстрее,\r\n// расскомментируйте строку с registerServiceWorker();\r\n// Но не забывайте, что на данный момент у технологии есть достаточно подводных камней\r\n// Подробнее про сервис воркеры можно почитать тут — https://vk.cc/8MHpmT\r\n// registerServiceWorker();\r\n\r\nReactDOM.render(\r\n\t<InstallingTheme>\r\n\t\t<AppSignProvider>\r\n\t\t\t<CurrentUserProvider>\r\n\t\t\t\t<App />\r\n\t\t\t</CurrentUserProvider>\r\n\t\t</AppSignProvider>\r\n\t</InstallingTheme>\r\n\t,\r\n\tdocument.getElementById('root')\r\n);\r\n","import { useState, useEffect } from 'react';\r\nimport qs from 'querystring';\r\nimport crypto from 'crypto';\r\n\r\nexport default () => {\r\n\tconst [urlParams, setUrlParams] = useState('');\r\n\tconst [isLoading, setIsLoading] = useState(false);\r\n\tconst [vkUserId, setVkUserId] = useState(null);\r\n\tconst [matchUrlParams, setMatch] = useState(false);\r\n\r\n\tconst setParams = (urlParams = '') => {\r\n\t\tsetUrlParams(urlParams);\r\n\t\tsetIsLoading(true);\r\n\t};\r\n\r\n\tuseEffect(() =>{\r\n\t\tif( !isLoading ) return;\r\n\r\n\t\tconst params = qs.parse(urlParams);\r\n\t\tconsole.log(params);\r\n\r\n\t\tif (!params) return;\r\n\r\n\t\tsetVkUserId(params.vk_user_id);\r\n\r\n\t\tconst ordered = {};\r\n\t\tObject.keys(params).sort().forEach((key) => {\r\n\t\t\tif (key.slice(0, 3) === 'vk_') {\r\n\t\t\t\tordered[key] = params[key];\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\tconst stringParams = qs.stringify(ordered);\r\n\t\tconst paramsHash = crypto\r\n\t\t\t.createHmac('sha256', 'Zs6DYRE8Z2mZ44LfciKW')\r\n\t\t\t.update(stringParams)\r\n\t\t\t.digest()\r\n\t\t\t.toString('base64')\r\n\t\t\t.replace(/\\+/g, '-')\r\n\t\t\t.replace(/\\//g, '_')\r\n\t\t\t.replace(/=$/, '');\r\n\r\n\t\tsetMatch(paramsHash === params.sign);\r\n\t}, [isLoading, urlParams]);\r\n\r\n\treturn [{vkUserId, matchUrlParams}, setParams];\r\n}"],"sourceRoot":""}