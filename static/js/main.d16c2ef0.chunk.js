(this["webpackJsonpvk-mini-apps-empty"]=this["webpackJsonpvk-mini-apps-empty"]||[]).push([[0],{268:function(e,t,a){e.exports=a(459)},356:function(e,t,a){},375:function(e,t){},377:function(e,t){},410:function(e,t){},411:function(e,t){},459:function(e,t,a){"use strict";a.r(t);a(269),a(295),a(297),a(298),a(300),a(301),a(302),a(303),a(304),a(305),a(306),a(307),a(309),a(310),a(311),a(312),a(313),a(314),a(315),a(316),a(317),a(318),a(320),a(321),a(322),a(323),a(324),a(325),a(326),a(327),a(328),a(329),a(330),a(331),a(332),a(333),a(334),a(335),a(336),a(337);var n=a(0),r=a.n(n),c=a(52),i=a.n(c),s=a(37),u=a.n(s),o=a(190),l=a(8),m=a(206),d=a.n(m),p=(a(345),a(50)),f=a(51),b=function(){function e(){Object(p.a)(this,e)}return Object(f.a)(e,null,[{key:"qr",value:function(e){var t,a,n,r,c;if(e){var i=e.match(/t=(\w{8}T\w+)&s=(\w+\.*\w+)&fn=(\w+)&i=(\w+)&fp=(\w+)/),s=Object(l.a)(i,6);t=s[1],a=s[2],n=s[3],r=s[4],c=s[5]}return{dt:t,sum:a,fn:n,i:r,fp:c}}},{key:"date",value:function(e){var t,a=new Date(e);switch(a.getMonth()+1){case 1:t="\u044f\u043d\u0432\u0430\u0440\u044f";break;case 2:t="\u0444\u0435\u0432\u0440\u0430\u043b\u044f";break;case 3:t="\u043c\u0430\u0440\u0442\u0430";break;case 4:t="\u0430\u043f\u0440\u0435\u043b\u044f";break;case 5:t="\u043c\u0430\u044f";break;case 6:t="\u0438\u044e\u043d\u044f";break;case 7:t="\u0438\u044e\u043b\u044f";break;case 8:t="\u0430\u0432\u0433\u0443\u0441\u0442\u0430";break;case 9:t="\u0441\u0435\u043d\u0442\u044f\u0431\u0440\u044f";break;case 10:t="\u043e\u043a\u0442\u044f\u0431\u0440\u044f";break;case 11:t="\u043d\u043e\u044f\u0431\u0440\u044f";break;case 12:t="\u0434\u0435\u043a\u0430\u0431\u0440\u044f"}return"".concat(a.getDate()," ").concat(t," ").concat(a.getFullYear())}},{key:"sum",value:function(e){return new Intl.NumberFormat("ru-RU",{style:"currency",currency:"RUB"}).format(e/100)}},{key:"totalReceiptSum",value:function(e){return e.map((function(e){return e.totalSum})).reduce((function(e,t){return e+t}))}},{key:"totalSum",value:function(e,t){var a=function(e,t){return e+t},n=e.map((function(e){return e.items.map((function(e){return t?e.income?e.sum:0:e.income?0:e.sum})).reduce(a)})).reduce(a);return t?n:-1*n}}]),e}(),h=a(207),y=a(86),v=a(81),E=a(87),O=a(16),j=a(83),g=a.n(j),k=a(84),_=a.n(k),x=a(85),S=a.n(x),w=a(203),q=a.n(w),C=a(204),T=a.n(C),A=function(e){var t=e.sum,a=e.fs,n=t>0?{color:"#28a745",fontSize:a}:{color:"#dc3545",fontSize:a};return r.a.createElement("span",{style:n},b.sum(t))},I=a(202),U=a.n(I),R=(a(356),a(82)),M=a.n(R),B=function(e){var t=e.items,a=e.id,n=t.map((function(e,t){var a=e.income?e.sum:-1*e.sum;return r.a.createElement("div",{key:t,className:"receipt-item"},r.a.createElement("span",{className:"receipt-item-name"},e.name),e.price?r.a.createElement("span",null,b.sum(e.price)):null,e.quantity?r.a.createElement("span",null,e.quantity):null,a?r.a.createElement("span",null,r.a.createElement(A,{sum:a})):null)}));return r.a.createElement(M.a,{id:a},r.a.createElement("div",{className:"receipt-item"},r.a.createElement("span",{className:"receipt-item-name"},"\u041d\u0430\u0438\u043c\u0435\u043d\u043e\u0432\u0430\u043d\u0438\u0435"),r.a.createElement("span",null,"\u0426\u0435\u043d\u0430"),r.a.createElement("span",null,"\u041a\u043e\u043b-\u0432\u043e"),r.a.createElement("span",null,"\u0421\u0443\u043c\u043c\u0430")),r.a.createElement(O.i,null),n)},L=a(121),z=a.n(L),F=a(192),P=a.n(F),H=a(59),N=a.n(H),D=a(193),K=a.n(D),W=a(194),J=a.n(W),V=a(195),Z=a.n(V),G=a(71),Y=a(89),$=a.n(Y),Q=a(196),X=a.n(Q),ee=a(197),te=a.n(ee),ae=a(200),ne=a.n(ae),re=a(198),ce=a.n(re),ie=a(199),se=a.n(ie),ue=function(e){function t(){var e,a;Object(p.a)(this,t);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(a=Object(y.a)(this,(e=Object(v.a)(t)).call.apply(e,[this].concat(r)))).state={name:"",quantity:1,price:0,sum:0,income:!1},a.onChange=function(e){var t=e.currentTarget,n=t.name,r=t.value,c=t.checked;"checkbox"!==t.type?a.setState(Object(G.a)({},n,r)):a.setState(Object(G.a)({},n,c))},a}return Object(E.a)(t,e),Object(f.a)(t,[{key:"render",value:function(){var e=Object(O.j)(),t=this.props,a=t.id,n=t.go;return r.a.createElement(g.a,{id:a},r.a.createElement(_.a,{left:r.a.createElement(N.a,{key:"back",onClick:n,"data-to":"balance"},e===O.a?r.a.createElement(te.a,null):r.a.createElement(X.a,null))},r.a.createElement(se.a,{before:r.a.createElement(N.a,{key:"qr"},r.a.createElement(ce.a,null))},"\u0414\u043e\u0431\u0430\u0432\u043b\u0435\u043d\u0438\u0435 \u0437\u0430\u043f\u0438\u0441\u0438")),r.a.createElement(M.a,null,r.a.createElement($.a,{type:"text",top:"\u041d\u0430\u0437\u0432\u0430\u043d\u0438\u0435",name:"name",value:this.state.name,onChange:this.onChange}),r.a.createElement($.a,{type:"number",top:"\u041a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e",name:"quantity",value:this.state.quantity,onChange:this.onChange}),r.a.createElement($.a,{type:"number",top:"\u0426\u0435\u043d\u0430",name:"price",value:this.state.price,onChange:this.onChange}),r.a.createElement(ne.a,{name:"income",value:this.state.income,onChange:this.onChange},"\u0414\u043e\u0445\u043e\u0434"),r.a.createElement(S.a,{size:"xl",mode:this.state.income?"commerce":"destructive"},"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c ",this.state.income?"\u0434\u043e\u0445\u043e\u0434":"\u0440\u0430\u0441\u0445\u043e\u0434")))}}]),t}(n.Component),oe=a(201),le=a.n(oe),me=function(e){var t=e.id;return r.a.createElement(O.f,{id:t},r.a.createElement(O.g,{before:r.a.createElement(le.a,null)},"\u0418\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u044f"))},de=function(e){function t(){var e,a;Object(p.a)(this,t);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(a=Object(y.a)(this,(e=Object(v.a)(t)).call.apply(e,[this].concat(r)))).state={activeModal:null,modalHistory:[]},a.modalBack=function(){a.setActiveModal(a.state.modalHistory[a.state.modalHistory.length-2])},a.setActiveModal=function(e){e=e||null;var t=a.state.modalHistory?Object(h.a)(a.state.modalHistory):[];null===e?t=[]:-1!==t.indexOf(e)?t=t.splice(0,t.indexOf(e)+1):t.push(e),a.setState({activeModal:e,modalHistory:t})},a}return Object(E.a)(t,e),Object(f.a)(t,[{key:"render",value:function(){var e=this,t=this.props,a=t.receipts,n=(t.fetchedUser,t.qr,t.go),c=t.popout,i=t.id,s=Object(O.j)(),u=r.a.createElement(O.e,{activeModal:this.state.activeModal},a.map((function(t,a){return r.a.createElement(O.c,{key:a,id:t._id,onClose:e.modalBack,header:r.a.createElement(O.d,{left:s!==O.a&&r.a.createElement(N.a,{onClick:e.modalBack},r.a.createElement(z.a,null)),right:s===O.a&&r.a.createElement(N.a,{onClick:e.modalBack},s===O.a?"\u0413\u043e\u0442\u043e\u0432\u043e":r.a.createElement(P.a,null))},b.date(t.dateTime))},r.a.createElement(O.b,null,r.a.createElement(B,{id:t._id,dateTime:t.dateTime,items:t.items})))})));return r.a.createElement(U.a,{id:"home",activePanel:i,popout:c,modal:u},r.a.createElement(g.a,{id:"balance"},r.a.createElement(_.a,null,"Balance"),r.a.createElement(O.h,{icon:r.a.createElement(K.a,null),header:r.a.createElement(A,{sum:b.totalReceiptSum(a),fs:"2em"}),action:r.a.createElement(S.a,{size:"l",onClick:n,"data-to":"addnote"},"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u0434\u043e\u0445\u043e\u0434 / \u0440\u0430\u0441\u0445\u043e\u0434")},"\u0414\u043e\u0431\u0430\u0432\u043b\u044f\u0439\u0442\u0435 \u0434\u043e\u0445\u043e\u0434\u044b/\u0440\u0430\u0441\u0445\u043e\u0434\u044b"),r.a.createElement(O.i,null),r.a.createElement("div",{style:{display:"flex",flexDirection:"row",justifyContent:"space-between",paddingTop:"1em"}},r.a.createElement("div",{style:{flex:"0 1 50%",display:"flex",justifyContent:"flex-end"}},r.a.createElement("div",{style:{display:"flex",flexDirection:"column",paddingRight:"10px"}},r.a.createElement("span",{style:{color:"#6F6F6F",fontSize:"0.7em",textAlign:"end"}},"\u0414\u043e\u0445\u043e\u0434\u044b"),r.a.createElement(A,{sum:b.totalSum(a,!0),fs:"1.4em"})),r.a.createElement(J.a,{width:16,height:40,fill:"#28a745"})),r.a.createElement("div",{style:{flex:"0 1 50%",display:"flex",justifyContent:"flex-start"}},r.a.createElement(Z.a,{width:16,height:40,fill:"#dc3545"}),r.a.createElement("div",{style:{display:"flex",flexDirection:"column",paddingLeft:"10px"}},r.a.createElement("span",{style:{color:"#6F6F6F",fontSize:"0.7em"}},"\u0420\u0430\u0441\u0445\u043e\u0434\u044b"),r.a.createElement(A,{sum:b.totalSum(a,!1),fs:"1.4em"})))),r.a.createElement(q.a,{title:"\u0427\u0435\u043a\u0438"},r.a.createElement(O.b,null,a.map((function(t,a){return r.a.createElement(T.a,{key:a,expandable:!0,onClick:function(t){return e.setActiveModal(t.currentTarget.dataset.to)},"data-to":t._id,indicator:r.a.createElement(A,{sum:t.totalSum})},b.date(t.dateTime))}))))),r.a.createElement(ue,{id:"addnote",go:n}),r.a.createElement(me,{id:"info"}))}}]),t}(n.Component),pe=a(30),fe=a.n(pe),be=a(88),he=function(){function e(){Object(p.a)(this,e),this._apiBase="http://localhost:3000/api"}return Object(f.a)(e,[{key:"callApi",value:function(e,t,a){var n,r,c,i,s;return fe.a.async((function(u){for(;;)switch(u.prev=u.next){case 0:return n=a.token,r=Object(be.a)(a,["token"]),c={"Content-Type":"application/json",Authorization:n?"Token ".concat(n):""},u.next=4,fe.a.awrap(fetch("".concat(this._apiBase).concat(t),{method:e,mode:"cors",headers:c,body:"GET"!==e?JSON.stringify(r):null}));case 4:if((i=u.sent).ok){u.next=9;break}throw(s=new Error("\u041e\u0448\u0438\u0431\u043a\u0430 \u0410\u0432\u0442\u043e\u0440\u0438\u0437\u0430\u0446\u0438\u0438")).subMessage="\u041d\u0435\u0432\u0435\u0440\u043d\u043e\u0435 \u0438\u043c\u044f \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f \u0438\u043b\u0438 \u043f\u0430\u0440\u043e\u043b\u044c",s;case 9:return u.next=11,fe.a.awrap(i.json());case 11:return u.abrupt("return",u.sent);case 12:case"end":return u.stop()}}),null,this)}},{key:"userLogin",value:function(e){return fe.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,fe.a.awrap(this.callApi("POST","/users/login",e));case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),null,this)}},{key:"userRegister",value:function(e){return fe.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,fe.a.awrap(this.callApi("POST","/users",e));case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),null,this)}},{key:"userCurrent",value:function(e){return fe.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,fe.a.awrap(this.callApi("GET","/users/current",e));case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),null,this)}},{key:"userUpdate",value:function(e){return fe.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,fe.a.awrap(this.callApi("PUT","/users/current",e));case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),null,this)}}]),e}(),ye=a(122),ve=a.n(ye),Ee=a(205),Oe=a.n(Ee),je=Object(n.createContext)([{},function(e){}]),ge=[{_id:"5ddf911573e0c321bc89f1ef",receipts:[{fn:"9289000100521868",fd:"12691",fp:"339287482"}],userId:"5dce89f495636e23345b7d34",dateTime:"2019-11-12T00:00:00.000",items:[{modifiers:[],properties:[],_id:"5ddf911573e0c321bc89f1f0",name:"test",sum:1e3,income:!0},{modifiers:[],properties:[],_id:"5de8e27933db3f375c2daa20",sum:490,quantity:1,name:"\u041f\u0430\u043a\u0435\u0442-\u043c\u0430\u0439\u043a\u0430 \u041c\u0430\u0433\u043d\u0438\u0442",price:490},{modifiers:[],properties:[],_id:"5de8e27933db3f375c2daa1f",sum:5490,quantity:1,name:"4 \u0421\u0415\u0417\u041e\u041d\u0410 \u0420\u0430\u0433\u0443 \u043e\u0432\u043e\u0449\u043d\u043e\u0435 0,4\u043a\u0433(\u0417\u0430\u043f\u0430\u0434\u043d\u044b\u0439 \u0425\u041a \u041e\u041e\u041e):20",price:5490},{modifiers:[],properties:[],_id:"5de8e27933db3f375c2daa1e",sum:22038,quantity:1.225,name:"\u0421\u043a\u0443\u043c\u0431\u0440\u0438\u044f \u0441/\u043c \u0443\u043f (\u0432\u0435\u0441):6",price:17990},{modifiers:[],properties:[],_id:"5de8e27933db3f375c2daa1d",sum:4490,quantity:1,name:"\u041a\u0420\u0410\u0421\u041a\u0418 \u041b\u0415\u0422\u0410 \u0421\u043e\u0442\u0435 400 \u0433 \u043f/\u0443\u043f(\u0420\u0443\u0441\u0441\u043a\u0430\u044f \u043e\u0432\u043e\u0449\u043d\u0430\u044f \u043a\u043e\u043c\u043f\u0430\u043d\u0438\u044f):8",price:4490},{modifiers:[],properties:[],_id:"5de8e27933db3f375c2daa1c",sum:3490,quantity:1,name:"MR RICCO Organic \u041c\u0430\u0439\u043e\u043d\u0435\u0437 \u043f\u0435\u0440\u0435\u043f \u044f\u0439\u0446\u0430 67% 375\u0433 \u0434/\u043f(\u041d\u044d\u0444\u0438\u0441):12",price:3490},{modifiers:[],properties:[],_id:"5de8e27933db3f375c2daa1b",sum:6490,quantity:1,name:'\u0422\u0432\u043e\u0440\u043e\u0433 \u043e\u0431\u0435\u0437\u0436\u0438\u0440\u0435\u043d\u043d\u044b\u0439 \u0412\u0435\u043c\u043e\u043b 0,5% 0,25\u043a\u0433 \u043a\u043e\u043d\u0442 (\u0417\u0410\u041e "\u0412\u0435\u043c\u043e\u043b") :18',price:6490},{modifiers:[],properties:[],_id:"5de8e27933db3f375c2daa1a",sum:6490,quantity:1,name:"\u0421\u043c\u0435\u0442\u0430\u043d\u0430 15% 0,45\u043a\u0433 \u0444/\u043f (\u041c\u043e\u043b\u043a\u043e\u043c\u0431\u0438\u043d\u0430\u0442 \u041a\u0443\u043d\u0433\u0443\u0440\u0441\u043a\u0438\u0439)",price:6490},{modifiers:[],properties:[],_id:"5de8e27933db3f375c2daa19",sum:7780,quantity:2,name:"\u041c\u043e\u043b\u043e\u043a\u043e \u043f\u0430\u0441\u0442 2,5% 1\u043b \u0444/\u043f (\u041c\u0430\u0421\u041a\u043e):15",price:3890},{modifiers:[],properties:[],_id:"5de8e27933db3f375c2daa18",sum:4790,quantity:1,name:"\u042f\u0439\u0446\u043e \u0441\u0442\u043e\u043b\u043e\u0432\u043e\u0435 \u04211 10\u0448\u0442 \u0431\u043e\u043a\u0441 :20",price:4790}],totalSum:-60548,__v:0},{_id:"5de8d0037a0bbc1cd8169744",receipts:[{fn:"9280440300403604",fd:"8950",fp:"0648032311"}],userId:"5dce89f495636e23345b7d34",dateTime:"2019-11-29T00:00:00.000",totalSum:-3663,items:[{modifiers:[],properties:[],_id:"5de8d0037a0bbc1cd8169746",sum:1063,price:1063,quantity:1,name:"\u0423\u0441\u043b\u0443\u0433\u0430 \u043f\u0438\u0442\u0430\u043d\u0438\u044f"},{modifiers:[],properties:[],_id:"5de8d0037a0bbc1cd8169745",sum:2600,price:2600,quantity:1,name:"\u0423\u0441\u043b\u0443\u0433\u0430 \u043f\u0438\u0442\u0430\u043d\u0438\u044f"}],__v:0},{_id:"5ddf912273e0c321bc89f1f5",receipts:[],userId:"5dce89f495636e23345b7d34",dateTime:"2019-11-15T00:00:00.000",items:[{modifiers:[],properties:[],_id:"5ddf912273e0c321bc89f1f6",name:"test",sum:1e6,income:!0},{modifiers:[],properties:[],_id:"5ddf99d96db8bf32044d2009",name:"test",sum:15e5,income:!0}],totalSum:25e5,__v:0},{_id:"5ddf912273e0c321bc89f1f6",receipts:[],userId:"5dce89f495636e23345b7d34",dateTime:"2020-02-09T14:16:00",items:[{price:590,properties:[],sum:590,name:"\u041f\u0430\u043a\u0435\u0442-\u043c\u0430\u0439\u043a\u0430 \u041c\u0430\u0433\u043d\u0438\u0442",quantity:1,modifiers:[]},{price:6292,properties:[],sum:881,name:"\u042f\u0411\u041b\u041e\u041a\u0418 \u043d\u043e\u0432\u044b\u0439 \u0443\u0440\u043e\u0436\u0430\u0439 1\u043a\u0433",quantity:.14,modifiers:[]},{price:6291,properties:[],sum:10821,name:"\u042f\u0411\u041b\u041e\u041a\u0418 \u043d\u043e\u0432\u044b\u0439 \u0443\u0440\u043e\u0436\u0430\u0439 1\u043a\u0433",quantity:1.72,modifiers:[]},{price:32447,properties:[],sum:16483,name:"\u0410\u0412\u041e\u041a\u0410\u0414\u041e 1\u043a\u0433",quantity:.508,modifiers:[]},{price:14832,properties:[],sum:2907,name:"\u041e\u0413\u0423\u0420\u0426\u042b \u0433\u043b\u0430\u0434\u043a\u0438\u0435 1\u043a\u0433",quantity:.196,modifiers:[]},{price:14831,properties:[],sum:9610,name:"\u041e\u0413\u0423\u0420\u0426\u042b \u0433\u043b\u0430\u0434\u043a\u0438\u0435 1\u043a\u0433",quantity:.648,modifiers:[]},{price:4490,properties:[],sum:8980,name:"\u0421\u0418\u0411\u0418\u0420\u0421\u041a\u0410\u042f \u042f\u0413\u041e\u0414\u0410 \u041f\u0440\u043e\u0442\u0435\u0440\u0442 \u0417\u0435\u043c\u043b\u044f\u043d\u0438\u043a\u04300,2",quantity:2,modifiers:[]},{price:4240,properties:[],sum:8480,name:"\u041c\u043e\u043b\u043e\u043a\u043e \u043f\u0430\u0441\u0442 2,5% 1\u043b \u0444/\u043f (\u041d\u044b\u0442\u0432\u0435\u043d\u0441\u043a\u0438\u0439",quantity:2,modifiers:[]},{price:1590,properties:[],sum:1590,name:"\u0421\u0410\u0414\u042b \u041f\u0420\u0418\u0414\u041e\u041d\u042c\u042f \u0421\u043e\u043a \u044f\u0431\u043b\u043e\u043a\u043e \u043f\u0435\u0440\u0441\u0438\u043a 0,2\u043b",quantity:1,modifiers:[]},{price:1590,properties:[],sum:1590,name:"\u0421\u0410\u0414\u042b \u041f\u0420\u0418\u0414\u041e\u041d\u042c\u042f \u0421\u043e\u043a \u043c\u0443\u043b\u044c\u0442\u0438\u0444\u0440\u0443\u043a\u0442\u043e\u0432\u044b\u0439 0,",quantity:1,modifiers:[]}],totalSum:-61932,__v:0}],ke=function(){var e=Object(n.useState)("balance"),t=Object(l.a)(e,2),a=t[0],c=t[1],i=Object(n.useState)(r.a.createElement(d.a,{size:"large"})),s=Object(l.a)(i,2),m=s[0],p=s[1],f=Object(n.useState)(""),h=Object(l.a)(f,2),y=h[0],v=h[1],E=Object(n.useState)(ge),O=Object(l.a)(E,2),j=O[0],g=(O[1],function(e){var t=Object(n.useState)(!1),a=Object(l.a)(t,2),r=a[0],c=a[1],i=Object(n.useState)(null),s=Object(l.a)(i,2),u=s[0],o=s[1],m=Object(n.useState)(null),d=Object(l.a)(m,2),p=d[0],f=d[1],b=Object(n.useState)({}),h=Object(l.a)(b,2),y=h[0],v=h[1],E=new he,O=Object(n.useCallback)((function(e){v(e),c(!0)}),[]),j=y.method,g=(y.token,Object(be.a)(y,["method","token"]));return Object(n.useEffect)((function(){r&&E.callApi(j,e,g).then((function(e){o(e),c(!1)})).catch((function(e){f(e),c(!1)}))}),[r,E,g,j,e]),[{isLoading:r,response:u,error:p},O]}("/users")),k=Object(l.a)(g,2),_=k[0],x=k[1],S=function(){var e=Object(n.useState)(""),t=Object(l.a)(e,2),a=t[0],r=t[1],c=Object(n.useState)(!1),i=Object(l.a)(c,2),s=i[0],u=i[1],o=Object(n.useState)(null),m=Object(l.a)(o,2),d=m[0],p=m[1],f=Object(n.useState)(!1),b=Object(l.a)(f,2),h=b[0],y=b[1];return Object(n.useEffect)((function(){if(s){var e=ve.a.parse(a);if(console.log(e),e){p(e.vk_user_id);var t={};Object.keys(e).sort().forEach((function(a){"vk_"===a.slice(0,3)&&(t[a]=e[a])}));var n=ve.a.stringify(t),r=Oe.a.createHmac("sha256","Zs6DYRE8Z2mZ44LfciKW").update(n).digest().toString("base64").replace(/\+/g,"-").replace(/\//g,"_").replace(/=$/,"");y(r===e.sign)}}}),[s,a]),[{vkUserId:d,matchUrlParams:h},function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";r(e),u(!0)}]}(),w=Object(l.a)(S,2),q=w[0],C=q.vkUserId,T=q.matchUrlParams,A=w[1],I=Object(n.useContext)(je),U=Object(l.a)(I,2),R=U[0],M=U[1];Object(n.useEffect)((function(){u.a.subscribe((function(e){var t=e.detail,a=t.type,n=t.data;switch(a){case"VKWebAppUpdateConfig":var r=document.createAttribute("scheme");r.value=n.scheme?n.scheme:"client_light",document.body.attributes.setNamedItem(r);break;case"VKWebAppOpenCodeReaderResult":v(n.code_data)}})),A(window.location.search.slice(1))}),[A]),Object(n.useEffect)((function(){C&&(x({method:"POST",user:{id:+C}}),p(null))}),[C,x]),Object(n.useEffect)((function(){_.response&&M((function(e){return Object(o.a)({},e,{isLoading:!1,isLoggedIn:!0,currentUser:_.response.user})}))}),[_.response,M]);var B=b.qr(y);return console.log(R.isLoggedIn),r.a.createElement("div",null,T?r.a.createElement(de,{id:a,go:function(e){c(e.currentTarget.dataset.to)},qr:B,receipts:j,popout:m}):null)};u.a.send("VKWebAppInit"),i.a.render(r.a.createElement((function(e){var t=e.children,a=Object(n.useState)({isLoading:!1,isLoggedIn:null,currentUser:null}),c=Object(l.a)(a,2),i=c[0],s=c[1];return r.a.createElement(je.Provider,{value:[i,s]},t)}),null,r.a.createElement(ke,null)),document.getElementById("root"))}},[[268,1,2]]]);
//# sourceMappingURL=main.d16c2ef0.chunk.js.map